const Discord = require('discord.js');
const mongoose = require('mongoose');
const Guild = require('../models/guild');

module.exports = async (client, message) => {
    const settings = await Guild.findOne({
        guildID: message.guild.id
    }, (err, guild) => {
        if (err) console.error(err)
    });
    if (!settings.logChannelID) {return true}
    if (oldMember.roles.cache.size > newMember.roles.cache.size) {
    message.guild.channels.cache.get(settings.logChannelID).send(new Discord.MessageEmbed()
    .setTitle(`Role Removed`)
    .setDescription(`**User: ** ${oldMember.user.username}#${oldMember.user.discriminator} \n**Role: **`, role)
    .setColor(process.env.EMBED_COLOR)
    .setFooter(process.env.EMBED_FOOTER, process.env.EMBED_FOOTER_IMAGE)
    )
};


// client.on("guildMemberUpdate", (oldMember, newMember) => {
//     // Old roles Collection is higher in size than the new one. A role has been removed.
//     if (oldMember.roles.cache.size > newMember.roles.cache.size) {
//         // Creating an embed message.
//         const Embed = new discord.MessageEmbed();
//         Embed.setColor("RED");
//         Embed.setAuthor(newMember.user.tag, newMember.user.avatarURL());
        
//         // Looping through the role and checking which role was removed.
//         oldMember.roles.cache.forEach(role => {
//             if (!newMember.roles.cache.has(role.id)) {
//                 Embed.addField("Role Removed", role);
//             }
//         });

//         client.channels.cache.get("ChannelID").send(Embed);
//     } else if (oldMember.roles.cache.size < newMember.roles.cache.size) {
//         const Embed = new discord.MessageEmbed();
//         Embed.setColor("GREEN");
//         Embed.setAuthor(newMember.user.tag, newMember.user.avatarURL());
        
//         // Looping through the role and checking which role was added.
//         newMember.roles.cache.forEach(role => {
//             if (!oldMember.roles.cache.has(role.id)) {
//                 Embed.addField("Role Added", role);
//             }
//         });
//         client.channels.cache.get("ChannelID").send(Embed);
//     }
};